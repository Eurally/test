window.__require=function e(t,n,a){function i(s,r){if(!n[s]){if(!t[s]){var h=s.split("/");if(h=h[h.length-1],!t[h]){var c="function"==typeof __require&&__require;if(!r&&c)return c(h,!0);if(o)return o(h,!0);throw new Error("Cannot find module '"+s+"'")}s=h}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){return i(t[s][1][e]||e)},d,d.exports,e,t,n,a)}return n[s].exports}for(var o="function"==typeof __require&&__require,s=0;s<a.length;s++)i(a[s]);return i}({arrow:[function(e,t,n){"use strict";cc._RF.push(t,"e79ddQJiupJd6B3HkbcDEqY","arrow"),cc.Class({extends:cc.Component,properties:{attack:5,speed:10,target:null,angle:0,time:0,cx:0,cy:0,sx:0,sy:0},start:function(){this.target&&(this.cx=(this.target.x+this.node.x)/2,this.cy=(this.target.y+this.node.y)/2+100,this.sx=this.node.x,this.sy=this.node.y)},update:function(e){if(null!=this.target)try{this.angle=Math.atan2(this.target.y-this.node.y,this.target.x-this.node.x),this.node.angle=180*this.angle/Math.PI,this.time+=e;var t=this.time*this.speed/10;this.node.x=(1-t)*(1-t)*this.sx+2*t*(1-t)*this.cx+t*t*this.target.x,this.node.y=(1-t)*(1-t)*this.sy+2*t*(1-t)*this.cy+t*t*this.target.y,t>1&&(Math.hypot(this.target.x-this.node.x,this.target.y-this.node.y)<=this.speed&&(this.target.getComponent("enemy").hp-=this.attack-this.target.getComponent("enemy").pdef),this.node.destroy())}catch(e){this.node.destroy()}else this.node.destroy()}}),cc._RF.pop()},{}],bartizan:[function(e,t,n){"use strict";cc._RF.push(t,"97ec6f5FLRIirb9v8AXPR0b","bartizan"),cc.Class({extends:cc.Component,properties:{firingRate:.5,attackRange:100,angle:0,level:1,createMoney:50,upMoney:60,maxLevel:3,attackGrowth:1,firingRateGrowth:.1,rangeGrowth:20,currentFrame:0,attackTargets:[],bullet:cc.Prefab},start:function(){var e=this;console.log(this.enemies),this.node.getChildByName("attackRange").width=2*this.attackRange,this.node.getChildByName("attackRange").height=2*this.attackRange,this.node.on(cc.Node.EventType.MOUSE_MOVE,function(){e.node.getChildByName("attackRange").active=!0},this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,function(){e.node.getChildByName("attackRange").active=!1},this),this.createBulletPool()},createBulletPool:function(){this.bulletPool=new cc.NodePool;for(var e=0;e<5;e++){var t=cc.instantiate(this.bullet);this.bulletPool.put(t)}},createBullet:function(e){var t=null;t=this.bulletPool.size()>0?this.bulletPool.get():cc.instantiate(this.bullet),cc.find("Canvas/map").addChild(t),t.x=this.node.parent.parent.x,t.y=this.node.parent.parent.y+20,t.getComponent("arrow").target=e},update:function(e){var t=cc.find("Canvas/map/enemies").children;this.currentFrame+=e;for(var n=[],a=0;a<t.length;a++)Math.hypot(t[a].x-this.node.parent.parent.x,t[a].y-this.node.parent.parent.y)<=this.attackRange&&n.push(t[a]);n.length>0&&this.currentFrame>this.firingRate&&(this.createBullet(n[0]),this.currentFrame=0)}}),cc._RF.pop()},{}],createTower:[function(e,t,n){"use strict";cc._RF.push(t,"a2bfai3V4JP5ZD184OfxplN","createTower"),cc.Class({extends:cc.Component,properties:{bartizan:cc.Prefab,mage:cc.Prefab,turret:cc.Prefab,guard:cc.Prefab,bartizanCreate:cc.Label,mageCreate:cc.Label,turretCreate:cc.Label,guardCreate:cc.Label,bartizanCreateMoney:50,mageCreateMoney:50,turretCreateMoney:50,guardCreateMoney:50},createBartizanPool:function(){this.bartizanPool=new cc.NodePool;var e=cc.instantiate(this.bartizan);this.bartizanPool.put(e)},createMagePool:function(){this.magePool=new cc.NodePool;var e=cc.instantiate(this.mage);this.magePool.put(e)},createTurretPool:function(){this.turretPool=new cc.NodePool;var e=cc.instantiate(this.turret);this.turretPool.put(e)},createGuardPool:function(){this.guardPool=new cc.NodePool;var e=cc.instantiate(this.guard);this.guardPool.put(e)},start:function(){var e=this;this.createBartizanPool(),this.createMagePool(),this.createTurretPool(),this.createGuardPool(),this.node.on(cc.Node.EventType.MOUSE_DOWN,function(){e.node.getChildByName("ring").active=!e.node.getChildByName("ring").active;for(var t=cc.find("Canvas/map/towerBases").children,n=0;n<t.length;n++)t[n]!=e.node&&(t[n].getChildByName("ring").active=!1)},this),this.node.getChildByName("ring").getChildByName("bartizan").on(cc.Node.EventType.MOUSE_DOWN,function(){var t=null;t=e.bartizanPool.size()>0?e.bartizanPool.get():cc.instantiate(e.bartizan),e.bartizanCreateMoney=t.getComponent("bartizan").createMoney,GameInfo.money-t.getComponent("bartizan").createMoney>=0&&(e.node.getChildByName("towers").addChild(t),GameInfo.money-=t.getComponent("bartizan").createMoney,e.closeRing())},this),this.node.getChildByName("ring").getChildByName("mage").on(cc.Node.EventType.MOUSE_DOWN,function(){var t=null;t=e.magePool.size()>0?e.magePool.get():cc.instantiate(e.mage),e.mageCreateMoney=t.getComponent("mage").createMoney,GameInfo.money-t.getComponent("mage").createMoney>=0&&(e.node.getChildByName("towers").addChild(t),GameInfo.money-=t.getComponent("mage").createMoney,e.closeRing())},this),this.node.getChildByName("ring").getChildByName("turret").on(cc.Node.EventType.MOUSE_DOWN,function(){var t=null;t=e.turretPool.size()>0?e.turretPool.get():cc.instantiate(e.turret),e.turretCreateMoney=t.getComponent("turret").createMoney,GameInfo.money-t.getComponent("turret").createMoney>=0&&(e.node.getChildByName("towers").addChild(t),GameInfo.money-=t.getComponent("turret").createMoney,e.closeRing())},this),this.node.getChildByName("ring").getChildByName("guard").on(cc.Node.EventType.MOUSE_DOWN,function(){var t=null;t=e.guardPool.size()>0?e.guardPool.get():cc.instantiate(e.guard),e.guardCreateMoney=t.getComponent("tower").createMoney,GameInfo.money-t.getComponent("tower").createMoney>=0&&(e.node.getChildByName("towers").addChild(t),GameInfo.money-=t.getComponent("tower").createMoney,e.closeRing())},this)},closeRing:function(){this.node.getChildByName("ring").active=!1,this.node.off(cc.Node.EventType.MOUSE_DOWN)},update:function(e){this.bartizanCreate.string="$ "+this.bartizanCreateMoney,this.mageCreate.string="$ "+this.mageCreateMoney,this.turretCreate.string="$ "+this.turretCreateMoney,this.guardCreate.string="$ "+this.guardCreateMoney}}),cc._RF.pop()},{}],enemy:[function(e,t,n){"use strict";cc._RF.push(t,"b95b5LC8pBPXIcOX+8IxcM1","enemy"),cc.Class({extends:cc.Component,properties:{maxHP:10,hp:10,speed:1,movePath:[],moveIndex:0,angle:0,time:0,destruction:1,goldCoin:5,pdef:1,mdef:0,blocked:null,attackRange:10,attack:5,attackTime:0,attackInterval:1},start:function(){this.node.x=this.movePath[this.moveIndex].x,this.node.y=this.movePath[this.moveIndex].y},move:function(e,t){this.angle=Math.atan2(t-this.node.y,e-this.node.x);var n=Math.cos(this.angle)*this.speed,a=Math.sin(this.angle)*this.speed,i=this.getComponent(cc.Animation);Math.abs(n)>Math.abs(a)?(this.time>1&&(i.play("runAni"),this.time=0),this.node.scaleX=n>0?1:-1):a>0?this.time>1&&(i.play("run_up"),this.time=0):this.time>1&&(i.play("run_down"),this.time=0),this.node.x+=n,this.node.y+=a},update:function(e){(this.time+=e,null==this.blocked)?this.movePath&&(this.moveIndex+1!=this.movePath.length?(this.move(this.movePath[this.moveIndex+1].x,this.movePath[this.moveIndex+1].y),Math.hypot(this.movePath[this.moveIndex+1].x-this.node.x,this.movePath[this.moveIndex+1].y-this.node.y)<=2*this.speed-1&&this.moveIndex++):(GameInfo.health-=this.destruction,GameInfo.appearEnemyCount++,this.node.destroy())):Math.hypot(this.blocked.x+this.blocked.parent.parent.parent.parent.x-this.node.x,this.blocked.y+this.blocked.parent.parent.parent.parent.y-this.node.y)<=this.attackRange?this.attackTime>this.attackInterval&&(this.getComponent(cc.Animation).play("attack"),this.blocked.getComponent("guard").hp-=this.attack,this.attackTime=0):this.move(this.blocked.x+this.blocked.parent.parent.parent.parent.x,this.blocked.y+this.blocked.parent.parent.parent.parent.y);this.node.getChildByName("bloodStick").getChildByName("hp").width=this.hp/this.maxHP*14,this.hp<=0&&(GameInfo.money+=this.goldCoin,GameInfo.appearEnemyCount++,null!=this.blocked&&(this.blocked.getComponent("guard").targetEnemy=null),this.node.destroy())}}),cc._RF.pop()},{}],game:[function(e,t,n){"use strict";cc._RF.push(t,"66eb65HEAdCYZ8AfXpOAw2l","game"),window.GameInfo={money:80,health:10,maxEnemyCount:30,appearEnemyCount:0,gameLevel:[!1]},cc.Class({extends:cc.Component,properties:{},start:function(){var e=this;cc.director.preloadScene("level_1",function(){cc.log("Next scene preloaded")});var t=this.node.getChildByName("level").children;GameInfo.gameLevel.forEach(function(n,a){n?(t[a].getChildByName("level_false").active=!1,t[a].getChildByName("level_true").active=!0,t[a].getChildByName("level_true").on(cc.Node.EventType.MOUSE_DOWN,function(){cc.director.loadScene("level_1")},e)):(t[a].getChildByName("level_false").active=!0,t[a].getChildByName("level_true").active=!1,t[a].getChildByName("level_false").on(cc.Node.EventType.MOUSE_DOWN,function(){cc.director.loadScene("level_1")},e))})}}),cc._RF.pop()},{}],guard:[function(e,t,n){"use strict";cc._RF.push(t,"66273OwzCxOjqTI779qSDkB","guard"),cc.Class({extends:cc.Component,properties:{maxHP:100,hp:100,speed:2,attack:5,angle:0,selectRange:100,attackRange:10,attackInterval:1,attackTime:0,massX:0,massY:0,massInstructions:!1,attackInstructions:!1,targetEnemy:null},move:function(e,t){var n=this.node.x+this.node.parent.parent.parent.parent.x,a=this.node.y+this.node.parent.parent.parent.parent.y;this.angle=Math.atan2(t-a,e-n);var i=Math.cos(this.angle)*this.speed,o=Math.sin(this.angle)*this.speed;this.node.scaleX=i>0?1:-1,this.node.x+=i,this.node.y+=o},start:function(){},update:function(e){if(this.massInstructions)this.move(this.massX,this.massY),Math.hypot(this.massX-(this.node.x+this.node.parent.parent.parent.parent.x),this.massY-(this.node.y+this.node.parent.parent.parent.parent.y))<=this.node.width&&(this.massInstructions=!1);else if(null==this.targetEnemy){for(var t=cc.find("Canvas/map/enemies").children,n=0;n<t.length;n++)if(Math.hypot(t[n].x-(this.node.x+this.node.parent.parent.parent.parent.x),t[n].y-(this.node.y+this.node.parent.parent.parent.parent.y))<=this.selectRange&&null==t[n].getComponent("enemy").blocked){this.targetEnemy=t[n];break}}else this.targetEnemy.getComponent("enemy").blocked=this.node,this.attackTime+=e,Math.hypot(this.targetEnemy.x-(this.node.x+this.node.parent.parent.parent.parent.x),this.targetEnemy.y-(this.node.y+this.node.parent.parent.parent.parent.y))<=this.attackRange?this.attackTime>this.attackInterval&&(this.getComponent(cc.Animation).play("attack"),this.targetEnemy.getComponent("enemy").hp-=this.attack,this.attackTime=0):this.move(this.targetEnemy.x-this.attackRange,this.targetEnemy.y);this.node.getChildByName("bloodStick").getChildByName("hp").width=this.hp/this.maxHP*14,this.hp<=0&&this.node.destroy()}}),cc._RF.pop()},{}],level_1:[function(e,t,n){"use strict";cc._RF.push(t,"ce1d2OG7hFLaLi2UjCAM32s","level_1"),cc.Class({extends:cc.Component,properties:{enemy_1:cc.Prefab,towerBase:cc.Prefab,health:cc.Label,money:cc.Label,currentEnemyCount:cc.Label,maxEnemyCount:cc.Label},initGameInfo:function(){GameInfo.money=80,GameInfo.health=10,GameInfo.maxEnemyCount=30,GameInfo.appearEnemyCount=0},start:function(){var e=this;this.initGameInfo(),this.node.getChildByName("enemy_start_bg").getChildByName("enemy_start").on(cc.Node.EventType.MOUSE_DOWN,function(){e.enemyPool_1=new cc.NodePool;for(var t=0;t<GameInfo.maxEnemyCount;t++){var n=cc.instantiate(e.enemy_1);e.enemyPool_1.put(n)}var a=0;e.schedule(function(){e.addEnemy(a),a++},.5,GameInfo.maxEnemyCount-1),e.node.getChildByName("enemy_start_bg").active=!1},this)},addEnemy:function(e){var t=null;t=this.enemyPool_1.size()>0?this.enemyPool_1.get():cc.instantiate(this.enemy_1),this.node.getChildByName("enemies").addChild(t);var n=60*Math.random()-30,a=200*Math.random();t.name="enemy_"+e,t.getComponent("enemy").movePath=this.createMovePath(n,a)},createMovePath:function(e,t){var n=[{x:456,y:671},{x:456,y:423},{x:429,y:390},{x:370,y:374},{x:300,y:350},{x:262,y:304},{x:261,y:255},{x:311,y:206},{x:518,y:210},{x:600,y:189},{x:664,y:190},{x:680,y:204},{x:770,y:263},{x:990,y:273}];return n[0].x+=e,n[0].y+=t,n},update:function(e){this.health.string=GameInfo.health,this.money.string=GameInfo.money,this.currentEnemyCount.string=cc.find("Canvas/map/enemies").children.length,this.maxEnemyCount.string=GameInfo.maxEnemyCount,GameInfo.health<=0&&(cc.find("Canvas/gameResult/doorLeft").x<=0&&(cc.find("Canvas/gameResult/doorLeft").x+=3),cc.find("Canvas/gameResult/doorRight").x>=0&&(cc.find("Canvas/gameResult/doorRight").x-=3),this.schedule(function(){cc.director.loadScene("game")},1,0,3)),GameInfo.appearEnemyCount==GameInfo.maxEnemyCount&&(GameInfo.gameLevel[0]=!0,this.schedule(function(){cc.find("Canvas/gameResult/victory").active=!0},1,0,1),this.schedule(function(){cc.director.loadScene("game")},1,0,3))}}),cc._RF.pop()},{}],mage:[function(e,t,n){"use strict";cc._RF.push(t,"2aea3u2ljFCS4HcpyqHEPmR","mage"),cc.Class({extends:cc.Component,properties:{firingRate:.5,attackRange:100,angle:0,level:1,createMoney:50,upMoney:60,maxLevel:3,attackGrowth:1,firingRateGrowth:.1,rangeGrowth:20,currentFrame:0,attackTargets:[],bullet:cc.Prefab},start:function(){var e=this;console.log(this.enemies),this.node.getChildByName("attackRange").width=2*this.attackRange,this.node.getChildByName("attackRange").height=2*this.attackRange,this.node.on(cc.Node.EventType.MOUSE_MOVE,function(){e.node.getChildByName("attackRange").active=!0},this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,function(){e.node.getChildByName("attackRange").active=!1},this),this.createBulletPool()},createBulletPool:function(){this.bulletPool=new cc.NodePool;for(var e=0;e<5;e++){var t=cc.instantiate(this.bullet);this.bulletPool.put(t)}},createBullet:function(e){var t=null;t=this.bulletPool.size()>0?this.bulletPool.get():cc.instantiate(this.bullet),cc.find("Canvas/map").addChild(t),t.x=this.node.parent.parent.x-6,t.y=this.node.parent.parent.y+28.5,t.getComponent("magicBullet").target=e},update:function(e){var t=cc.find("Canvas/map/enemies").children;this.currentFrame+=e;for(var n=[],a=0;a<t.length;a++)Math.hypot(t[a].x-this.node.parent.parent.x,t[a].y-this.node.parent.parent.y)<=this.attackRange&&n.push(t[a]);n.length>0&&this.currentFrame>this.firingRate&&(this.createBullet(n[0]),this.currentFrame=0)}}),cc._RF.pop()},{}],magicBullet:[function(e,t,n){"use strict";cc._RF.push(t,"e2dc8v1cNZImLxFW1exwSUc","magicBullet"),cc.Class({extends:cc.Component,properties:{attack:5,speed:10,target:null,angle:0},start:function(){},update:function(e){if(this.target)try{this.angle=Math.atan2(this.target.y-this.node.y,this.target.x-this.node.x),this.node.angle=180*this.angle/Math.PI,this.node.x+=Math.cos(this.angle)*this.speed,this.node.y+=Math.sin(this.angle)*this.speed,Math.hypot(this.target.x-this.node.x,this.target.y-this.node.y)<=this.speed&&(this.target.getComponent("enemy").hp-=this.attack-this.target.getComponent("enemy").mdef,this.node.destroy())}catch(e){this.node.destroy()}else this.node.destroy()}}),cc._RF.pop()},{}],shell:[function(e,t,n){"use strict";cc._RF.push(t,"1d29dwsrxNJUoUrTE78E55z","shell"),cc.Class({extends:cc.Component,properties:{attack:5,speed:10,target:null,angle:0,attackRange:50,time:0,cx:0,cy:0,sx:0,sy:0,ex:0,ey:0,ismove:!0,explode:null},start:function(){this.cx=(this.target.x+this.node.x)/2,this.cy=(this.target.y+this.node.y)/2+100,this.sx=this.node.x,this.sy=this.node.y,this.ex=this.target.x,this.ey=this.target.y},update:function(e){if(this.ismove){this.angle=Math.atan2(this.ey-this.node.y,this.ex-this.node.x),this.node.angle=180*this.angle/Math.PI,this.time+=e;var t=this.time*this.speed/10;if(this.node.x=(1-t)*(1-t)*this.sx+2*t*(1-t)*this.cx+t*t*this.ex,this.node.y=(1-t)*(1-t)*this.sy+2*t*(1-t)*this.cy+t*t*this.ey,t>1){this.explode.x=this.node.x-this.explode.parent.parent.parent.x,this.explode.y=this.node.y-this.explode.parent.parent.parent.y,this.explode.getComponent(cc.Animation).play("explode");for(var n=cc.find("Canvas/map/enemies").children,a=0;a<n.length;a++)Math.hypot(n[a].x-this.node.x,n[a].y-this.node.y)<=this.attackRange&&(n[a].getComponent("enemy").hp-=this.attack-n[a].getComponent("enemy").pdef);this.ismove=!1,this.node.destroy()}}}}),cc._RF.pop()},{}],tower:[function(e,t,n){"use strict";cc._RF.push(t,"c10ec0GQjlFS6J4qjnYJTIl","tower"),cc.Class({extends:cc.Component,properties:{aggregateRange:100,level:1,createMoney:50,upMoney:60,maxLevel:3,rangeGrowth:20,guard:cc.Prefab,time:0,index:0,guardPos:[]},start:function(){var e=this;this.node.getChildByName("aggregateRange").width=2*this.aggregateRange,this.node.getChildByName("aggregateRange").height=2*this.aggregateRange,this.node.on(cc.Node.EventType.MOUSE_DOWN,function(){e.node.getChildByName("aggregateRange").active=!e.node.getChildByName("aggregateRange").active}),this.node.getChildByName("aggregateRange").on(cc.Node.EventType.MOUSE_DOWN,function(){e.createGuardPool()}),this.guardPos.push({x:50,y:30},{x:30,y:50},{x:70,y:50})},createGuardPool:function(){this.guardPool=new cc.NodePool;for(var e=0;e<3;e++){var t=cc.instantiate(this.guard);this.guardPool.put(t),this.createGuard()}},createGuard:function(){var e=null;e=this.guardPool.size()>0?this.guardPool.get():cc.instantiate(this.guard),this.node.getChildByName("guards").addChild(e),e.name="guard_"+this.index,e.getComponent("guard").massInstructions=!0,e.getComponent("guard").massX=this.node.parent.parent.x+this.guardPos[this.index].x,e.getComponent("guard").massY=this.node.parent.parent.y-this.guardPos[this.index].y,this.index++},update:function(e){this.time+=e,this.node.getChildByName("guards").children.length<3&&this.time>5&&this.createGuard()}}),cc._RF.pop()},{}],turret:[function(e,t,n){"use strict";cc._RF.push(t,"4a7bdYAp49JJJwbosAhZ6Lg","turret"),cc.Class({extends:cc.Component,properties:{firingRate:.5,attackRange:100,angle:0,level:1,createMoney:50,upMoney:60,maxLevel:3,attackGrowth:1,firingRateGrowth:.1,rangeGrowth:20,currentFrame:0,attackTargets:[],bullet:cc.Prefab},start:function(){var e=this;console.log(this.enemies),this.node.getChildByName("attackRange").width=2*this.attackRange,this.node.getChildByName("attackRange").height=2*this.attackRange,this.node.on(cc.Node.EventType.MOUSE_MOVE,function(){e.node.getChildByName("attackRange").active=!0},this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,function(){e.node.getChildByName("attackRange").active=!1},this),this.createBulletPool()},createBulletPool:function(){this.bulletPool=new cc.NodePool;for(var e=0;e<5;e++){var t=cc.instantiate(this.bullet);this.bulletPool.put(t)}},createBullet:function(e){var t=null;t=this.bulletPool.size()>0?this.bulletPool.get():cc.instantiate(this.bullet),cc.find("Canvas/map").addChild(t),t.x=this.node.parent.parent.x+3,t.y=this.node.parent.parent.y+36,t.getComponent("shell").target=e,t.getComponent("shell").explode=this.node.getChildByName("explode")},update:function(e){if(this.currentFrame+=e,this.currentFrame>this.firingRate){for(var t=cc.find("Canvas/map/enemies").children,n=[],a=0;a<t.length;a++)Math.hypot(t[a].x-this.node.parent.parent.x,t[a].y-this.node.parent.parent.y)<=this.attackRange&&n.push(t[a]);n.length>0&&(this.createBullet(n[0]),this.currentFrame=0)}}}),cc._RF.pop()},{}]},{},["enemy","game","level_1","arrow","bartizan","createTower","guard","tower","mage","magicBullet","shell","turret"]);